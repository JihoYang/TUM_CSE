A = [1e-20 1; 1 1];
[L,U,P] = lu(A);
L

L =

                         1                         0
                     1e-20                         1

U

U =

     1     1
     0     1

P

P =

     0     1
     1     0

P*A

ans =

                         1                         1
                     1e-20                         1

L*U

ans =

                         1                         1
                     1e-20                         1

e1 = [1;0]


z = L\(P*e1)

z =

     0
     1

x = U\z

x =

    -1
     1

x = A\e1

x =

    -1
     1

A = randn(10,10);
format short g
[L,U,P] = lu(A);
L

L =

  Columns 1 through 5

            1            0            0            0            0
      0.51249            1            0            0            0
     -0.63125      0.69822            1            0            0
      0.08908      0.25477      0.43691            1            0
      0.77393      0.14125     -0.44456      0.66033            1
     -0.36544      0.13401      0.71534     -0.45896     -0.64526
     0.095748      0.58577      0.25065     0.024555      0.31314
      0.24094     -0.17405      0.71478      0.72917     -0.07846
      0.15025      -0.6752     -0.15648      0.12898     -0.18553
     -0.12117     0.020143      0.42672    -0.021002     -0.35327

  Columns 6 through 10

            0            0            0            0            0
            0            0            0            0            0
            0            0            0            0            0
            0            0            0            0            0
            0            0            0            0            0
            1            0            0            0            0
      0.19916            1            0            0            0
     -0.13561     -0.53512            1            0            0
      -0.3366    -0.063155     -0.23851            1            0
    -0.028505       0.3932     -0.63532      0.94706            1

spy(L); shg
spy(U); shg
spy(P); shg

A = randn(50,50);
[L,U,P] = lu(A);
spy(L); shg
spy(P); shg
[L,U,p] = lu(A,'vector');
p

p =

  Columns 1 through 11

    21    15    38    50    18    31    29    48    27    19     5

  Columns 12 through 22

    25    40    34    46    39    37    22    11     2    41    26

  Columns 23 through 33

     1    43     4    17     3    30    14    13     9    45    24

  Columns 34 through 44

    36    42    28    47     6    44    12    16     7    32    10

  Columns 45 through 50

    23     8    49    33    35    20

I = eye(50);
P1 = I(p,:);
norm(P1-P)

ans =

     0

b = randn(50,1);
xx = A\b;
z = L\b(p);
x = U\z;
norm(x-xx)

ans =

     0

x

x =

     -0.15092
      -3.0906
      -2.5107
     -0.72189
       3.9866
       3.7195
       -5.082
      -2.8136
      -1.8402
      0.35374
       4.4534
      0.17719
      0.20407
       1.8252
      -5.6115
      -2.4242
       1.0014
      -6.6448
       1.6994
       2.3872
       2.0058
       7.8052
       2.9289
      -1.8644
      -3.3819
         5.28
       7.9534
      -1.0947
        -9.22
      -5.4019
       1.8374
       5.8986
       1.2237
       2.4907
     0.053939
      -2.1914
      -0.3889
      -2.9136
      0.62397
       3.3375
        1.914
       2.0815
      -0.2264
      -1.3949
      0.46203
       2.8335
       2.2188
       4.0219
        1.029
      0.67722

r = b - A*x;
omega = norm(r,inf)/(norm(A,inf)*norm(x,inf))

omega =

   1.0543e-16

A = A*A';
norm(A-A')

ans =

     0

x = randn(50,1);
x'*A*x

ans =

       1610.4

L = chol(A,'lower');
spy(L), shg
norm(A-L*L')

ans =

   2.7962e-14

