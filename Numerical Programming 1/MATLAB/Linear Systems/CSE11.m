help condest
    1-norm condition number estimate

    This MATLAB function computes a lower bound c for the 1-norm condition number of
    a square matrix A.

    c = <strong>condest</strong>(A)
    c = <strong>condest</strong>(A,t)
    [c,v] = <strong>condest</strong>(A)


A = randn(100);
size(A)

ans =

   100   100

condest(A)

ans =

          1707.43739261148

cond(A,1)

ans =

          2372.20819538531

cond(A,inf)

ans =

          2691.51715542157

condest(A')

ans =

           2691.5171554216

m = 20; A = hilb(m);
format short g
A(1:5,1:5)

ans =

            1          0.5      0.33333         0.25          0.2
          0.5      0.33333         0.25          0.2      0.16667
      0.33333         0.25          0.2      0.16667      0.14286
         0.25          0.2      0.16667      0.14286        0.125
          0.2      0.16667      0.14286        0.125      0.11111

B = invhilb(m);
b = ones(m,1);
x = B*b

x =

      -20.013
         7984
  -7.8994e+05
   3.4323e+07
  -8.2468e+08
   1.2336e+10
   -1.249e+11
   8.9641e+11
  -4.7055e+12
    1.851e+13
  -5.5528e+13
   1.2821e+14
  -2.2781e+14
   3.1057e+14
  -3.2383e+14
   2.5252e+14
  -1.4199e+14
   5.4473e+13
  -1.2762e+13
   1.3782e+12

xx = A\b
[Warning: Matrix is close to singular or badly scaled. Results may be
inaccurate. RCOND =  1.155429e-19.] 

xx =

      -19.955
       2699.5
       -86695
   1.1156e+06
  -6.5638e+06
   1.3713e+07
   3.7769e+07
  -2.8873e+08
   6.9728e+08
  -7.9507e+08
   5.0433e+08
   -7.747e+08
   1.4689e+09
  -5.2117e+08
  -1.7255e+09
   1.9262e+09
   7.5678e+07
  -1.1667e+09
   6.7626e+08
  -1.2283e+08

[x xx]

ans =

      -20.013      -19.955
         7984       2699.5
  -7.8994e+05       -86695
   3.4323e+07   1.1156e+06
  -8.2468e+08  -6.5638e+06
   1.2336e+10   1.3713e+07
   -1.249e+11   3.7769e+07
   8.9641e+11  -2.8873e+08
  -4.7055e+12   6.9728e+08
    1.851e+13  -7.9507e+08
  -5.5528e+13   5.0433e+08
   1.2821e+14   -7.747e+08
  -2.2781e+14   1.4689e+09
   3.1057e+14  -5.2117e+08
  -3.2383e+14  -1.7255e+09
   2.5252e+14   1.9262e+09
  -1.4199e+14   7.5678e+07
   5.4473e+13  -1.1667e+09
  -1.2762e+13   6.7626e+08
   1.3782e+12  -1.2283e+08

norm(x-xx,inf)/norm(xx,inf)

ans =

   1.6812e+05

condest(A')

ans =

   2.4764e+19

condest(A')*eps

ans =

       5498.8

condest(A')*eps % condition number wrt to inf-norm

ans =

       5498.8

rank(A)

ans =

    13

null(A)

ans =

  Columns 1 through 5

  -9.9742e-08   1.2095e-08  -2.5458e-09   7.4812e-09  -9.5064e-10
   1.3436e-05   -1.992e-06   3.8278e-07  -1.2054e-06    1.012e-07
   -0.0004423    8.058e-05  -1.4052e-05   4.7996e-05  -1.3378e-06
    0.0061542   -0.0013939   0.00021854   -0.0008229    -3.76e-05
    -0.044253     0.012725   -0.0017748    0.0075151    0.0010866
      0.17795    -0.067412    0.0083459    -0.040427    -0.011444
     -0.39698      0.21307    -0.024554       0.1337      0.06542
      0.41149     -0.38114     0.052878     -0.27132     -0.22374
     0.026349      0.27454     -0.11483      0.32102      0.45953
     -0.35285      0.23219      0.26337     -0.21336     -0.50319
    -0.037695     -0.55971     -0.42707      0.19851      0.10326
      0.29046      0.22197      0.27265     -0.46592      0.37319
      0.18098     0.085809      0.29415      0.61198      -0.2715
     -0.18414      0.17586     -0.60692     -0.31166      -0.1836
     -0.28371      -0.1874      0.18245    0.0090988      0.24182
   -0.0053038     -0.28331       0.2856    -0.010726    -0.049117
      0.30267      0.29388      -0.1299   -0.0075908      0.14654
      0.15563      0.12848     -0.18994      0.12426     -0.30898
     -0.38305       -0.227      0.18037      -0.1158      0.20896
      0.13674     0.068727     -0.04504      0.03149    -0.048201

  Columns 6 through 7

    1.741e-09  -1.2552e-09
  -2.7063e-07    2.445e-07
   1.0407e-05  -1.1492e-05
   -0.0001732   0.00023009
    0.0015541    -0.002448
   -0.0084188     0.015409
     0.029401    -0.060285
    -0.068554      0.14705
      0.10548      -0.2094
    -0.087064      0.12748
    -0.037556      0.05468
      0.21123    -0.095814
     -0.20169     0.014701
      -0.1085      -0.1867
      0.32137      0.58537
     0.012728     -0.65785
      -0.5462      0.29518
      0.61907     0.019361
      -0.2984    -0.062932
     0.055708     0.015971

x

x =

      -20.013
         7984
  -7.8994e+05
   3.4323e+07
  -8.2468e+08
   1.2336e+10
   -1.249e+11
   8.9641e+11
  -4.7055e+12
    1.851e+13
  -5.5528e+13
   1.2821e+14
  -2.2781e+14
   3.1057e+14
  -3.2383e+14
   2.5252e+14
  -1.4199e+14
   5.4473e+13
  -1.2762e+13
   1.3782e+12

xx

xx =

      -19.955
       2699.5
       -86695
   1.1156e+06
  -6.5638e+06
   1.3713e+07
   3.7769e+07
  -2.8873e+08
   6.9728e+08
  -7.9507e+08
   5.0433e+08
   -7.747e+08
   1.4689e+09
  -5.2117e+08
  -1.7255e+09
   1.9262e+09
   7.5678e+07
  -1.1667e+09
   6.7626e+08
  -1.2283e+08

r_x = b - A*x;
omega_x = norm(r_x,inf)/(norm(A,inf)*norm(x,inf))

omega_x =

   1.2787e-05

omega_x/eps

ans =

   5.7588e+10

r_xx = b - A*xx;
omega_xx = norm(r_xx,inf)/(norm(A,inf)*norm(xx,inf))

omega_xx =

   3.3597e-18

m = 25;
A = 2*eye(m) - tril(ones(m)); A(:,m) = 1; % Wilkinson matrix
A

A =

  Columns 1 through 11

     1     0     0     0     0     0     0     0     0     0     0
    -1     1     0     0     0     0     0     0     0     0     0
    -1    -1     1     0     0     0     0     0     0     0     0
    -1    -1    -1     1     0     0     0     0     0     0     0
    -1    -1    -1    -1     1     0     0     0     0     0     0
    -1    -1    -1    -1    -1     1     0     0     0     0     0
    -1    -1    -1    -1    -1    -1     1     0     0     0     0
    -1    -1    -1    -1    -1    -1    -1     1     0     0     0
    -1    -1    -1    -1    -1    -1    -1    -1     1     0     0
    -1    -1    -1    -1    -1    -1    -1    -1    -1     1     0
    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1     1
    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1
    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1
    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1
    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1
    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1
    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1
    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1
    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1
    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1
    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1
    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1
    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1
    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1
    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1

  Columns 12 through 22

     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0
     1     0     0     0     0     0     0     0     0     0     0
    -1     1     0     0     0     0     0     0     0     0     0
    -1    -1     1     0     0     0     0     0     0     0     0
    -1    -1    -1     1     0     0     0     0     0     0     0
    -1    -1    -1    -1     1     0     0     0     0     0     0
    -1    -1    -1    -1    -1     1     0     0     0     0     0
    -1    -1    -1    -1    -1    -1     1     0     0     0     0
    -1    -1    -1    -1    -1    -1    -1     1     0     0     0
    -1    -1    -1    -1    -1    -1    -1    -1     1     0     0
    -1    -1    -1    -1    -1    -1    -1    -1    -1     1     0
    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1     1
    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1
    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1
    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1    -1

  Columns 23 through 25

     0     0     1
     0     0     1
     0     0     1
     0     0     1
     0     0     1
     0     0     1
     0     0     1
     0     0     1
     0     0     1
     0     0     1
     0     0     1
     0     0     1
     0     0     1
     0     0     1
     0     0     1
     0     0     1
     0     0     1
     0     0     1
     0     0     1
     0     0     1
     0     0     1
     0     0     1
     1     0     1
    -1     1     1
    -1    -1   

rng(847); b = randn(m,1);
x = A\b;
r = b - A*x;
omega = norm(r,inf)/(norm(A,inf)*norm(x,inf))

omega =

       9.9352193602411e-12

condest(A')

ans =

    25

err = condest(A')*omega

err =

      2.48380484006028e-10
